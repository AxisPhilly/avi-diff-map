<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Property Tax Changes | AxisPhilly</title>
    <link rel="stylesheet" href="css/leaflet.css" />
    <!--[if lte IE 8]>
      <link rel="stylesheet" href="css/leaflet.ie.css" />
    <![endif]-->
    <link rel="icon" href="http://axisphilly.org/news/wp-content/themes/ally/images/favicon.png" type="image/x-icon" />
    <link rel="shortcut icon" href="http://axisphilly.org/news/wp-content/themes/ally/images/favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="css/app.css" type="text/css">
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36899552-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body>
    <header>
      <div id="show" class="toggle container"><i>&#8615</i> Expand</div>
      <div id="info" class="container">
        <h2>Property Tax Changes</h2>
        <div id="hide" class="toggle"><i>&#8613</i> Collapse</div>
        <p class="description">
          This map shows how much taxes would change for most properties if council passes a tax rate of 1.34% and a $30,000 Homestead Exemption. We'll be updating it as the city decides what the final rate will be. <br><br>Search for a specific to zoom in on a neighborhood. Hover over a parcel to get more detailed information for that parcel.
        </p>
        <p class="note"><em>Note: Parcels that could not be matched to a tax record or had incomplete tax data are not shown.</em>
        </p>
        <hr>
        <p>Search for a Philadelphia address: </p>
        <form id="geocoder"></form>
      </div>
      <div id="tooltip" class="container">

      </div>
    </header>
    <section>
      <div id="map"></div>
    </section>
    <footer>
    </footer>
    <script type="text/javascript" src="js/leaflet.js"></script>
    <script type="text/javascript" src="js/wax.leaf.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript" src="js/jquery.geocodify.js"></script>
    <script type="text/javascript" src="js/underscore.min.js"></script>
    <script type="text/javascript" src="js/app.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
          // Setup geocoding
          $("#geocoder").geocodify({
            onSelect: function (result) { 
              app.map
                .panTo(new L.LatLng(result.geometry.location.Ya, result.geometry.location.Za))
                .setZoom(17);
            },
            viewportBias: new google.maps.LatLngBounds(
             new google.maps.LatLng(39.884, -75.318),
             new google.maps.LatLng(40.130, -74.881)
            ) 
          });

          // Bind toggle
          $("#hide").click(function(){
            $(".description").slideUp();
            $(".note").slideUp();
            $("#show").show();
          })

          $("#show").click(function(){
            $(".description").slideDown();
            $(".note").slideDown();
            $("#show").hide();
          });

          // Default settings. Overridden by URL params, if they exist
          app.opts = {
            mapContainer: 'map',
            tileURL: 'http://api.tiles.mapbox.com/v3/axisphilly.map-edzrbggs.jsonp',
            mapOptions: {
              center: [39.978, -75.174],
              zoom: 13,
              minZoom: 11,
              maxZoom: 18,
              maxBounds: [
                [39.69, -76.20],
                [40.60, -74.14]
              ]
            }
          }

          // Kick off map
          app.initMap(function() {
            app.map.attributionControl.addAttribution(
              'Map Data: City of Philadelphia; ' +
              'Basemap Data: (c) <a href="http://www.openstreetmap.org">OpenStreetMap</a>; ' + 
              'Colors: <a href="http://colorbrewer2.org/">ColorBrewer.org</a>'
            );

            $('span.middle').css({
              'background': '#777'
            })

            // Insert embed code
            $('.embed').click(function(){
              alert('Use this code to embed this map at the current location and zoom level: <iframe width="100%" height="600" src="' + document.URL + '" frameborder="0"></iframe>');
            });

          });
        });
    </script>
  </body>
</html>